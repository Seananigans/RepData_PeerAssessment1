---
title: "Reproducible Research: Peer Assessment 1"
author: "Sean Hegarty"
date: "January 17, 2015"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
1. Load the data using `read.csv` function.
```{r}
data <- read.csv("activity.csv", 
                 colClasses = c("integer","Date","numeric"))
```
2. Process/transform the data into an `NA` free format suitable for analysis.
```{r}
data.Rna <- na.omit(data)
```

## What is mean total number of steps taken per day?
1. Make a histogram of the total number of steps taken each day

```{r}
dailySteps <- aggregate(steps ~ date, 
                        data = data.Rna, 
                        FUN = sum)
names(dailySteps) <- c("date","steps")
barplot(dailySteps$steps, 
        names.arg = dailySteps$date, 
        main = "Total Steps taken Daily",
        xlab = "date", ylab = "steps")
```

2. Calculate and report the mean and median total number of steps taken per day
```{r}
mean(dailySteps$steps)
median(dailySteps$steps)
```


## What is the average daily activity pattern?
1. Make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r}
intervalSteps <- aggregate(steps~interval, 
                           data = data.Rna, 
                           FUN = mean)
names(intervalSteps)<-c("interval","steps")
plot(type = "l", intervalSteps, 
     main = "Average Steps per Time Interval",
     xlab = "Interval in Minutes", ylab = "Steps")
```

2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of average steps?
```{r}
intervalSteps[intervalSteps$steps == max(intervalSteps$steps),]
```


## Imputing missing values
1. Total number of missing values in the dataset
```{r}
sum(is.na(data))
```

2. Devise/Create/Plot/Calculate

        + Devise a strategy for filling in all of the missing values in the dataset with the interval mean. 
        
        + Create a new dataset that is equal to the original dataset but with the missing data filled in.
```{r}
data.intMean <- merge(data, intervalSteps, 
                      by = "interval", 
                      suffixes = c("", ".intMean"))
NAs <- is.na(data.intMean$steps)
data.intMean$steps[NAs] <- data.intMean$steps.intMean[NAs]
data.intMean <- data.intMean[, c(1:3)]
```

        + Plot a histogram of the total number of steps taken daily. 
```{r}
dailySteps2 <- aggregate(steps ~ date, 
                         data = data.intMean, 
                         FUN = sum)
barplot(dailySteps2$steps, names.arg = dailySteps2$date,
        main = "Total Steps taken Daily with Means as NAs",
        xlab = "date", ylab = "steps")
```

        + Calculate the mean and median total number of steps taken daily.
```{r}
mean(dailySteps2$steps)
median(dailySteps2$steps)
```

3. Replacing `NA` values with the mean interval values allows the median to match the mean. This was not the case in the original `data`. Imputing `NA` data changes the descriptive statistics.
```{r}
mean(dailySteps2$steps) - mean(dailySteps$steps)
median(dailySteps2$steps) - median(dailySteps$steps)
```

## Are there differences in activity patterns between weekdays and weekends?

1. Create a new factor variable in the dataset with two levels – “weekday” and “weekend”.
```{r}
day <- function(date) {
    ifelse (weekdays(as.Date(date)) %in% c("Saturday", "Sunday"), "weekend", "weekday")
}
data.intMean$day <- as.factor(sapply(data.intMean$date, day))
table(data.intMean$day)
```

2. Panel plot a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekdays or weekend days (y-axis).
```{r}
par(mfrow = c(2, 1))
for (type in c("weekend", "weekday")) {
    dayType <- aggregate(steps ~ interval, 
                            data = data.intMean, 
                            subset = data.intMean$day == type, 
                            FUN = mean)
    plot(dayType, type = "l", main = type, 
         xlab = "Interval in Minutes", ylab = "Steps")
}
```